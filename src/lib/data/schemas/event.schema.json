{
    "$schema": "http://json-schema.org/draft-07/schema",

    "type": "object",
    "required": ["slug", "name", "duration", "participants", "matches"],
    "additionalProperties": false,
    "properties": {
        "$schema": { "type": "string", "format": "uri-reference" },

        "slug": { "$ref": "../schemas/slug.schema.json" },
        "name": { "type": "string" },
        "duration": { "$ref": "../schemas/daterange.schema.json" },
        "urls": { "type": "object", "propertyNames": { "type": "string" }, "additionalProperties": { "type": "string", "format": "uri" } },
        "participants": { "type": "object", "propertyNames": { "$ref": "../schemas/slug.schema.json" }, "additionalProperties": { "$ref": "../schemas/slug.schema.json" } },
        "matches": { "type": "array", "items": { "$ref": "#/$defs/match" } },
        "note": { "type": "string" }
    },

    "$defs": {
        "match": {
            "type": "object",
            "required": ["slug", "bracket", "date", "matchup", "maps"],
            "additionalProperties": false,
            "properties": {
                "slug": { "$ref": "../schemas/slug.schema.json" },
                "bracket": { "type": "array", "items": { "type": "string" } },
                "date": { "type": "string", "format": "date" },
                "matchup": { "$ref": "#/$defs/matchup" },
                "url": { "type": "string", "format": "uri" },
                "maps": { "type": "array", "items": { "$ref": "#/$defs/map" } },
                "note": { "type": "string" }
            }
        },

        "matchup": {
            "type": "object",
            "required": ["team1", "team2"],
            "additionalProperties": false,
            "properties": {
                "team1": { "type": "string" },
                "team2": { "type": "string" }
            }
        },

        "map": {
            "type": "object",
            "required": ["slug", "map", "result"],
            "additionalProperties": false,
            "properties": {
                "slug": { "type": "string", "pattern": "^map[1-5]$" },
                "map": { "$ref": "../schemas/cs-map.schema.json" },
                "result": { "type": "string", "pattern": "^[0-9]+:[0-9]+$" },
                "url": { "type": "string", "format": "uri" },
                "streams": { "type": "array", "items": { "$ref": "#/$defs/stream" } },
                "note": { "type": "string" }
            }
        },

        "stream": {
            "type": "object",
            "required": ["caster", "language", "parts"],
            "additionalProperties": false,
            "properties": {
                "caster": { "type": "string" },
                "language": { "$ref": "../schemas/language.schema.json" },
                "parts": { "type": "array", "items": { "$ref": "#/$defs/stream-part" } },
                "tags": { "type": "array", "items": { "$ref": "#/$defs/stream-tag" } }
            }
        },
        "stream-part": {
            "type": "object",
            "required": ["name", "url"],
            "properties": {
                "name": { "type": "string" },
                "url": { "type": "string", "format": "uri" },
                "duration": { "$ref": "../schemas/timerange.schema.json" }
            }
        },
        "stream-tag": {
            "type": "string",
            "enum": ["official", "incomplete"]
        }
    }
}
